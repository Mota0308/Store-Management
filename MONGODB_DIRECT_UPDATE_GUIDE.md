# MongoDB ç›´æ¥æ›´æ–°æŒ‡å—

## æ–¹æ³•äºŒï¼šä½¿ç”¨ Node.js è„šæœ¬ç›´æ¥ä¿®æ”¹ MongoDB æ•°æ®

è¿™ä¸ªè„šæœ¬å¯ä»¥ç›´æ¥è¿æ¥åˆ°ç”Ÿäº§æ•°æ®åº“å¹¶ä¿®æ”¹ç”¨æˆ·æ•°æ®ï¼Œæ— éœ€é€šè¿‡ APIã€‚

## å¿«é€Ÿå¼€å§‹

### 1. åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·

```bash
cd server
node direct_update_mongodb.js --list
```

æˆ–ä½¿ç”¨ npm è„šæœ¬ï¼š
```bash
npm run mongodb:list
```

### 2. æ›´æ–°ç”¨æˆ·å¯†ç 

```bash
cd server
node direct_update_mongodb.js -u admin -p newpassword123
```

### 3. æ›´æ–°ç”¨æˆ·é‚®ç®±

```bash
cd server
node direct_update_mongodb.js -u admin -e newemail@example.com
```

### 4. åŒæ—¶æ›´æ–°å¯†ç å’Œé‚®ç®±

```bash
cd server
node direct_update_mongodb.js -u admin -p newpassword123 -e newemail@example.com
```

## å‚æ•°è¯´æ˜

| å‚æ•° | ç®€å†™ | è¯´æ˜ | å¿…éœ€ |
|------|------|------|------|
| `--username` | `-u` | è¦æ›´æ–°çš„ç”¨æˆ·åæˆ–é‚®ç®± | æ˜¯ï¼ˆæ›´æ–°æ—¶ï¼‰ |
| `--password` | `-p` | æ–°å¯†ç ï¼ˆè‡³å°‘6ä¸ªå­—ç¬¦ï¼‰ | å¦ |
| `--email` | `-e` | æ–°é‚®ç®±åœ°å€ | å¦ |
| `--list` | `-l` | åˆ—å‡ºæ‰€æœ‰ç”¨æˆ· | å¦ |

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: æ›´æ–° admin ç”¨æˆ·å¯†ç 

```bash
cd server
node direct_update_mongodb.js -u admin -p Admin@2024
```

è¾“å‡ºï¼š
```
âœ… å·²é€£æ¥åˆ° MongoDB ç”Ÿç”¢æ•¸æ“šåº«

æ‰¾åˆ°ç”¨æˆ¶: admin (admin@example.com)

âœ… å¯†ç¢¼å·²åŠ å¯†æº–å‚™æ›´æ–°

âœ… æ›´æ–°æˆåŠŸï¼

æ›´æ–°å¾Œçš„ç”¨æˆ¶ä¿¡æ¯:
  ç”¨æˆ¶å: admin
  éƒµç®±: admin@example.com
  æ–°å¯†ç¢¼: Admin@2024
  å¯†ç¢¼å“ˆå¸Œ: $2b$10$abcdefghijklmn...
  æ›´æ–°æ™‚é–“: 2024-01-15T10:30:00.000Z

âœ… æ•¸æ“šåº«é€£æ¥å·²é—œé–‰
```

### ç¤ºä¾‹ 2: æ›´æ–° testuser çš„é‚®ç®±

```bash
cd server
node direct_update_mongodb.js -u testuser -e testuser@newdomain.com
```

### ç¤ºä¾‹ 3: æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·

```bash
cd server
node direct_update_mongodb.js --list
```

è¾“å‡ºï¼š
```
âœ… å·²é€£æ¥åˆ° MongoDB ç”Ÿç”¢æ•¸æ“šåº«

ğŸ“‹ æ‰€æœ‰ç”¨æˆ¶åˆ—è¡¨:

1. ç”¨æˆ¶å: admin
   éƒµç®±: admin@example.com
   å‰µå»ºæ™‚é–“: 2024-01-10T08:00:00.000Z
   æ›´æ–°æ™‚é–“: 2024-01-15T10:30:00.000Z

2. ç”¨æˆ¶å: testuser
   éƒµç®±: test@example.com
   å‰µå»ºæ™‚é–“: 2024-01-10T08:05:00.000Z
   æ›´æ–°æ™‚é–“: 2024-01-10T08:05:00.000Z

3. ç”¨æˆ¶å: manager
   éƒµç®±: manager@example.com
   å‰µå»ºæ™‚é–“: 2024-01-10T08:10:00.000Z
   æ›´æ–°æ™‚é–“: 2024-01-10T08:10:00.000Z

âœ… æ•¸æ“šåº«é€£æ¥å·²é—œé–‰
```

## ä½¿ç”¨ npm è„šæœ¬ï¼ˆæ¨èï¼‰

åœ¨ `package.json` ä¸­å·²æ·»åŠ ä¾¿æ·è„šæœ¬ï¼š

```bash
# åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·
npm run mongodb:list

# æ›´æ–°ç”¨æˆ·ï¼ˆéœ€è¦æä¾›å‚æ•°ï¼‰
npm run mongodb:update -- -u admin -p newpassword123
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **å¯†ç åŠ å¯†**: è„šæœ¬ä¼šè‡ªåŠ¨ä½¿ç”¨ bcrypt åŠ å¯†å¯†ç 
2. **é‚®ç®±éªŒè¯**: è„šæœ¬ä¼šéªŒè¯é‚®ç®±æ ¼å¼å’Œå”¯ä¸€æ€§
3. **ç›´æ¥è¿æ¥**: è„šæœ¬ç›´æ¥è¿æ¥åˆ°ç”Ÿäº§æ•°æ®åº“ï¼Œè¯·è°¨æ…ä½¿ç”¨
4. **æƒé™æ§åˆ¶**: ç¡®ä¿åªæœ‰æˆæƒäººå‘˜å¯ä»¥è¿è¡Œæ­¤è„šæœ¬

## é”™è¯¯å¤„ç†

### é”™è¯¯: æ‰¾ä¸åˆ°ç”¨æˆ·

```
âŒ éŒ¯èª¤: æ‰¾ä¸åˆ°ç”¨æˆ¶ "admin"
```

**è§£å†³æ–¹æ³•**: ç¡®è®¤ç”¨æˆ·åæˆ–é‚®ç®±æ­£ç¡®ï¼Œæˆ–ä½¿ç”¨ `--list` æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·

### é”™è¯¯: å¯†ç é•¿åº¦ä¸è¶³

```
âŒ éŒ¯èª¤: å¯†ç¢¼é•·åº¦è‡³å°‘éœ€è¦6å€‹å­—ç¬¦
```

**è§£å†³æ–¹æ³•**: ä½¿ç”¨è‡³å°‘6ä¸ªå­—ç¬¦çš„å¯†ç 

### é”™è¯¯: é‚®ç®±å·²è¢«ä½¿ç”¨

```
âŒ éŒ¯èª¤: éƒµç®± "newemail@example.com" å·²è¢«å…¶ä»–ç”¨æˆ¶ä½¿ç”¨
```

**è§£å†³æ–¹æ³•**: ä½¿ç”¨æœªè¢«å…¶ä»–ç”¨æˆ·ä½¿ç”¨çš„é‚®ç®±

### é”™è¯¯: æ— æ•ˆçš„é‚®ç®±æ ¼å¼

```
âŒ éŒ¯èª¤: ç„¡æ•ˆçš„éƒµç®±æ ¼å¼
```

**è§£å†³æ–¹æ³•**: ä½¿ç”¨æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼ï¼ˆä¾‹å¦‚ï¼šuser@example.comï¼‰

## ä¸ Railway CLI ç»“åˆä½¿ç”¨

```bash
# 1. æ›´æ–°æ•°æ®åº“ä¸­çš„ç”¨æˆ·å¯†ç 
cd server
node direct_update_mongodb.js -u admin -p newpassword123

# 2. æäº¤ä»£ç ï¼ˆå¦‚æœæœ‰æ›´æ”¹ï¼‰
cd ..
git add .
git commit -m "Update user password"
git push

# 3. Railway ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²
# æˆ–è€…ä½¿ç”¨ Railway CLI
railway up
```

## ä¼˜åŠ¿

1. **ç›´æ¥æ“ä½œ**: æ— éœ€é€šè¿‡ APIï¼Œç›´æ¥ä¿®æ”¹æ•°æ®åº“
2. **å¿«é€Ÿ**: ç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€ç­‰å¾…éƒ¨ç½²
3. **å®‰å…¨**: å¯†ç è‡ªåŠ¨åŠ å¯†ï¼Œé‚®ç®±æ ¼å¼éªŒè¯
4. **çµæ´»**: å¯ä»¥åŒæ—¶æ›´æ–°å¤šä¸ªå­—æ®µ

## æ³¨æ„äº‹é¡¹

- è„šæœ¬ç›´æ¥è¿æ¥åˆ°ç”Ÿäº§æ•°æ®åº“ï¼Œè¯·ç¡®ä¿ï¼š
  - æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²æ­£ç¡®
  - æœ‰é€‚å½“çš„ç½‘ç»œè®¿é—®æƒé™
  - æ“ä½œå‰å¤‡ä»½é‡è¦æ•°æ®ï¼ˆå¯é€‰ï¼‰
- å¯†ç æ›´æ–°åï¼Œç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•
- é‚®ç®±æ›´æ–°åï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æ–°é‚®ç®±ç™»å½•

